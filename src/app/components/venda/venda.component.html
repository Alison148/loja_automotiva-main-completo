<div class="container mt-5 pt-5">
  <h2 class="text-center mb-4 text-success fw-bold">
    ğŸ’¸ Realizar Venda
  </h2>

  <div *ngIf="!caixaAberto" class="alert alert-danger text-center fw-bold">
    âš ï¸ Ã‰ necessÃ¡rio abrir o caixa para realizar vendas!
  </div>

  <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 g-4">
    <div class="col" *ngFor="let peca of pecasDisponiveis">
      <div class="card h-100 shadow-sm border-0">
        <div class="card-body d-flex flex-column">
          <h5 class="card-title text-primary fw-semibold">
            ğŸ§¾ {{ peca.nome }}
          </h5>

          <ul class="list-unstyled mb-3">
            <li><strong>ğŸ’° PreÃ§o:</strong> {{ peca.preco | currency:'BRL' }}</li>
            <li><strong>ğŸ“¦ Estoque:</strong> {{ peca.estoque }}</li>
          </ul>

          <div class="mb-3">
            <label for="quantidade-{{ peca.nome }}" class="form-label fw-semibold">
              ğŸ”¢ Quantidade
            </label>
            <input
              id="quantidade-{{ peca.nome }}"
              type="number"
              class="form-control"
              [(ngModel)]="quantidadeSelecionada[peca.nome]"
              [min]="1"
              [max]="peca.estoque"
              [disabled]="!caixaAberto || peca.estoque === 0"
              placeholder="Digite a quantidade"
              [ngClass]="{
                'is-invalid': quantidadeSelecionada[peca.nome] > peca.estoque,
                'is-valid': quantidadeSelecionada[peca.nome] > 0 && quantidadeSelecionada[peca.nome] <= peca.estoque
              }"
            />
            <div class="invalid-feedback">
              Quantidade excede o estoque disponÃ­vel.
            </div>
          </div>

          <button
            class="btn btn-success mt-auto d-flex justify-content-center align-items-center gap-2"
            (click)="vender(peca)"
            [disabled]="
              !caixaAberto || 
              !quantidadeSelecionada[peca.nome] || 
              quantidadeSelecionada[peca.nome] > peca.estoque
            "
          >
            <i class="fas fa-cart-plus"></i> Vender
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
<select [(ngModel)]="formaPagamento" class="form-select">
  <option>Dinheiro</option>
  <option>CartÃ£o de CrÃ©dito</option>
  <option>PIX</option>
  <option>DÃ©bito</option>
</select>

<div *ngIf="formaPagamento === 'CartÃ£o de CrÃ©dito'" class="mt-2">
  <label for="parcelas">Parcelas:</label>
  <input type="number" min="1" max="12" [(ngModel)]="parcelas" class="form-control" />
</div>
